ccd:
  postgres:
    enabled: true
  elastic:
    enabled: true

java:
  # Don't modify below here
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  environment:
    CASE_DATA_STORE_BASEURL: "http://localhost:4452"
    CITIZEN_UPDATE_CASE_STATE_ENABLED: true
    BOOT_WITH_CCD: true
    CFT_LIB_NO_DOCKER: true
    CFT_LIB_DB_HOST: "{{ .Release.Name }}-postgresql"
  keyVaults:
    nfdiv:
      secrets:
        - name: nfdiv-case-api-dot-env
        - name: AppInsightsInstrumentationKey-Preview
          alias: APP_INSIGHTS_KEY
        - name: uk-gov-notify-api-key
          alias: UK_GOV_NOTIFY_API_KEY
        - name: s2s-case-api-secret
          alias: S2S_SECRET
        - name: idam-secret
          alias: IDAM_CLIENT_SECRET
        - name: idam-systemupdate-username
          alias: IDAM_SYSTEM_UPDATE_USERNAME
        - name: idam-systemupdate-password
          alias: IDAM_SYSTEM_UPDATE_PASSWORD

postgresql:
  persistence:
    enabled: true
  resources:
    requests:
      cpu: 25m
  initdbScripts:
    init.sql: |-
      CREATE DATABASE "data-store" WITH OWNER = postgres ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "definition-store" WITH OWNER = postgres ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "user-profile" WITH OWNER = postgres ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "am" WITH OWNER = postgres ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
  postgresqlUsername: postgres
  postgresqlPassword: postgres
  postgresqlDatabase: ccd

#elasticsearch:
#  clusterName: "es"
#  imageTag: "6.4.2"
#  replicas: 1
#  minimumMasterNodes: 1
#  antiAffinity: "soft"
#  esJavaOpts: "-Xmx512m -Xms512m"
#  persistence:
#    enabled: false
#  ingress:
#    enabled: true
#    annotations:
#      kubernetes.io/ingress.class: traefik
#    path: /
#    hosts:
#      - ""
#
#logstash:
#  image:
#    repository: hmctspublic.azurecr.io/ccd/logstash
#    tag: latest
#    pullPolicy: IfNotPresent
#  logstashJavaOpts: -Xmx1g -Xms512M
#  persistence:
#    enabled: false
#  volumeMounts:
#    - name: pipeline
#      mountPath: /usr/share/logstash/files # hack to prevent override of default pipeline in the custom image hmcts/ccd-logstash
#  elasticsearch:
#    host: "{{ .Release.Name }}-es-master"
#    port: 9200
#  configTpl:
#    xpack.monitoring.enabled: "false"
#    db.url: "jdbc:postgresql://{{ .Release.Name }}-postgresql:5432/data-store?stringtype=unspecified"
#    db.user: "hmcts"
#    db.pwd: "hmcts"
#    es.data.nodes.url: "http://{{ .Release.Name }}-es-master:9200"
